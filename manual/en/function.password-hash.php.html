<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>PHP: password_hash - Manual </title>

 <link rel="shortcut icon" href="https://www.php.net/favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="https://www.php.net/manual/en/function.password-hash.php">
 <link rel="shorturl" href="https://www.php.net/password-hash">
 <link rel="alternate" href="https://www.php.net/password-hash" hreflang="x-default">

 <link rel="contents" href="https://www.php.net/manual/en/index.php">
 <link rel="index" href="https://www.php.net/manual/en/ref.password.php">
 <link rel="prev" href="https://www.php.net/manual/en/function.password-get-info.php">
 <link rel="next" href="https://www.php.net/manual/en/function.password-needs-rehash.php">

 <link rel="alternate" href="https://www.php.net/manual/en/function.password-hash.php" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.password-hash.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.password-hash.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.password-hash.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.password-hash.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.password-hash.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.password-hash.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.password-hash.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.password-hash.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="/cached.php?t=1639034403&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="/cached.php?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="/cached.php?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="/cached.php?t=1647366004&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base href="https://www.php.net/manual/en/function.password-hash.php">


</head>
<body class="docs ">

<nav id="head-nav" class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <a href="/" class="brand"><img src="/images/logos/php-logo.svg" width="48" height="24" alt="php"></a>
    <div id="mainmenu-toggle-overlay"></div>
    <input type="checkbox" id="mainmenu-toggle">
    <ul class="nav">
      <li class=""><a href="/downloads">Downloads</a></li>
      <li class="active"><a href="/docs.php">Documentation</a></li>
      <li class=""><a href="/get-involved" >Get Involved</a></li>
      <li class=""><a href="/support">Help</a></li>
      <li class="">
        <a href="/releases/8.1/index.php">
          <img src="/images/php8/logo_php8_1.svg" alt="php8.1" height="22" width="60">
        </a>
      </li>
    </ul>
    <form class="navbar-search" id="topsearch" action="/search.php">
      <input type="hidden" name="show" value="quickref">
      <input type="search" name="pattern" class="search-query" placeholder="Search" accesskey="s">
    </form>
  </div>
  <div id="flash-message"></div>
</nav>
<div class="headsup"><a href='/index.php#id2022-03-17-1'>PHP 8.0.17 Released!</a></div>
<nav id="trick"><div><dl>
<dt><a href='/manual/en/getting-started.php'>Getting Started</a></dt>
	<dd><a href='/manual/en/introduction.php'>Introduction</a></dd>
	<dd><a href='/manual/en/tutorial.php'>A simple tutorial</a></dd>
<dt><a href='/manual/en/langref.php'>Language Reference</a></dt>
	<dd><a href='/manual/en/language.basic-syntax.php'>Basic syntax</a></dd>
	<dd><a href='/manual/en/language.types.php'>Types</a></dd>
	<dd><a href='/manual/en/language.variables.php'>Variables</a></dd>
	<dd><a href='/manual/en/language.constants.php'>Constants</a></dd>
	<dd><a href='/manual/en/language.expressions.php'>Expressions</a></dd>
	<dd><a href='/manual/en/language.operators.php'>Operators</a></dd>
	<dd><a href='/manual/en/language.control-structures.php'>Control Structures</a></dd>
	<dd><a href='/manual/en/language.functions.php'>Functions</a></dd>
	<dd><a href='/manual/en/language.oop5.php'>Classes and Objects</a></dd>
	<dd><a href='/manual/en/language.namespaces.php'>Namespaces</a></dd>
	<dd><a href='/manual/en/language.enumerations.php'>Enumerations</a></dd>
	<dd><a href='/manual/en/language.errors.php'>Errors</a></dd>
	<dd><a href='/manual/en/language.exceptions.php'>Exceptions</a></dd>
	<dd><a href='/manual/en/language.fibers.php'>Fibers</a></dd>
	<dd><a href='/manual/en/language.generators.php'>Generators</a></dd>
	<dd><a href='/manual/en/language.attributes.php'>Attributes</a></dd>
	<dd><a href='/manual/en/language.references.php'>References Explained</a></dd>
	<dd><a href='/manual/en/reserved.variables.php'>Predefined Variables</a></dd>
	<dd><a href='/manual/en/reserved.exceptions.php'>Predefined Exceptions</a></dd>
	<dd><a href='/manual/en/reserved.interfaces.php'>Predefined Interfaces and Classes</a></dd>
	<dd><a href='/manual/en/context.php'>Context options and parameters</a></dd>
	<dd><a href='/manual/en/wrappers.php'>Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href='/manual/en/security.php'>Security</a></dt>
	<dd><a href='/manual/en/security.intro.php'>Introduction</a></dd>
	<dd><a href='/manual/en/security.general.php'>General considerations</a></dd>
	<dd><a href='/manual/en/security.cgi-bin.php'>Installed as CGI binary</a></dd>
	<dd><a href='/manual/en/security.apache.php'>Installed as an Apache module</a></dd>
	<dd><a href='/manual/en/security.sessions.php'>Session Security</a></dd>
	<dd><a href='/manual/en/security.filesystem.php'>Filesystem Security</a></dd>
	<dd><a href='/manual/en/security.database.php'>Database Security</a></dd>
	<dd><a href='/manual/en/security.errors.php'>Error Reporting</a></dd>
	<dd><a href='/manual/en/security.variables.php'>User Submitted Data</a></dd>
	<dd><a href='/manual/en/security.hiding.php'>Hiding PHP</a></dd>
	<dd><a href='/manual/en/security.current.php'>Keeping Current</a></dd>
<dt><a href='/manual/en/features.php'>Features</a></dt>
	<dd><a href='/manual/en/features.http-auth.php'>HTTP authentication with PHP</a></dd>
	<dd><a href='/manual/en/features.cookies.php'>Cookies</a></dd>
	<dd><a href='/manual/en/features.sessions.php'>Sessions</a></dd>
	<dd><a href='/manual/en/features.xforms.php'>Dealing with XForms</a></dd>
	<dd><a href='/manual/en/features.file-upload.php'>Handling file uploads</a></dd>
	<dd><a href='/manual/en/features.remote-files.php'>Using remote files</a></dd>
	<dd><a href='/manual/en/features.connection-handling.php'>Connection handling</a></dd>
	<dd><a href='/manual/en/features.persistent-connections.php'>Persistent Database Connections</a></dd>
	<dd><a href='/manual/en/features.commandline.php'>Command line usage</a></dd>
	<dd><a href='/manual/en/features.gc.php'>Garbage Collection</a></dd>
	<dd><a href='/manual/en/features.dtrace.php'>DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href='/manual/en/funcref.php'>Function Reference</a></dt>
	<dd><a href='/manual/en/refs.basic.php.php'>Affecting PHP's Behaviour</a></dd>
	<dd><a href='/manual/en/refs.utilspec.audio.php'>Audio Formats Manipulation</a></dd>
	<dd><a href='/manual/en/refs.remote.auth.php'>Authentication Services</a></dd>
	<dd><a href='/manual/en/refs.utilspec.cmdline.php'>Command Line Specific Extensions</a></dd>
	<dd><a href='/manual/en/refs.compression.php'>Compression and Archive Extensions</a></dd>
	<dd><a href='/manual/en/refs.crypto.php'>Cryptography Extensions</a></dd>
	<dd><a href='/manual/en/refs.database.php'>Database Extensions</a></dd>
	<dd><a href='/manual/en/refs.calendar.php'>Date and Time Related Extensions</a></dd>
	<dd><a href='/manual/en/refs.fileprocess.file.php'>File System Related Extensions</a></dd>
	<dd><a href='/manual/en/refs.international.php'>Human Language and Character Encoding Support</a></dd>
	<dd><a href='/manual/en/refs.utilspec.image.php'>Image Processing and Generation</a></dd>
	<dd><a href='/manual/en/refs.remote.mail.php'>Mail Related Extensions</a></dd>
	<dd><a href='/manual/en/refs.math.php'>Mathematical Extensions</a></dd>
	<dd><a href='/manual/en/refs.utilspec.nontext.php'>Non-Text MIME Output</a></dd>
	<dd><a href='/manual/en/refs.fileprocess.process.php'>Process Control Extensions</a></dd>
	<dd><a href='/manual/en/refs.basic.other.php'>Other Basic Extensions</a></dd>
	<dd><a href='/manual/en/refs.remote.other.php'>Other Services</a></dd>
	<dd><a href='/manual/en/refs.search.php'>Search Engine Extensions</a></dd>
	<dd><a href='/manual/en/refs.utilspec.server.php'>Server Specific Extensions</a></dd>
	<dd><a href='/manual/en/refs.basic.session.php'>Session Extensions</a></dd>
	<dd><a href='/manual/en/refs.basic.text.php'>Text Processing</a></dd>
	<dd><a href='/manual/en/refs.basic.vartype.php'>Variable and Type Related Extensions</a></dd>
	<dd><a href='/manual/en/refs.webservice.php'>Web Services</a></dd>
	<dd><a href='/manual/en/refs.utilspec.windows.php'>Windows Only Extensions</a></dd>
	<dd><a href='/manual/en/refs.xml.php'>XML Manipulation</a></dd>
	<dd><a href='/manual/en/refs.ui.php'>GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="clearfix">
    <div id="breadcrumbs-inner">
          <div class="next">
        <a href="function.password-needs-rehash.php">
          password_needs_rehash &raquo;
        </a>
      </div>
              <div class="prev">
        <a href="function.password-get-info.php">
          &laquo; password_get_info        </a>
      </div>
          <ul>
            <li><a href='index.php'>PHP Manual</a></li>      <li><a href='funcref.php'>Function Reference</a></li>      <li><a href='refs.crypto.php'>Cryptography Extensions</a></li>      <li><a href='book.password.php'>Password Hashing</a></li>      <li><a href='ref.password.php'>Password Hashing Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div class="page-tools">
    <div class="change-language">
      <form action="/manual/change.php" method="get" id="changelang" name="changelang">
        <fieldset>
          <label for="changelang-langs">Change language:</label>
          <select onchange="document.changelang.submit()" name="page" id="changelang-langs">
            <option value='en/function.password-hash.php' selected="selected">English</option>
            <option value='pt_BR/function.password-hash.php'>Brazilian Portuguese</option>
            <option value='zh/function.password-hash.php'>Chinese (Simplified)</option>
            <option value='fr/function.password-hash.php'>French</option>
            <option value='de/function.password-hash.php'>German</option>
            <option value='ja/function.password-hash.php'>Japanese</option>
            <option value='ru/function.password-hash.php'>Russian</option>
            <option value='es/function.password-hash.php'>Spanish</option>
            <option value='tr/function.password-hash.php'>Turkish</option>
            <option value="help-translate.php">Other</option>
          </select>
        </fieldset>
      </form>
    </div>
    <div class="edit-bug">
      <a href="https://github.com/php/doc-en/blob/master/reference/password/functions/password-hash.xml">Submit a Pull Request</a>
      <a href="https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.password-hash%0A%0A---">Report a Bug</a>
    </div>
  </div><div id="function.password-hash" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">password_hash</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">password_hash</span> &mdash; <span class="dc-title">Creates a password hash</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.password-hash-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>password_hash</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>, <span class="methodparam"><span class="type"><span class="type">string</span>|<span class="type">int</span>|<span class="type">null</span></span> <code class="parameter">$algo</code></span>, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = []</span></span>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>password_hash()</strong></span> creates a new password hash using a strong one-way hashing
   algorithm.
  </p>
  <p class="simpara">
   The following algorithms are currently supported:
  </p>
  <p class="para">
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_DEFAULT</code></strong> - Use the bcrypt algorithm (default as of PHP 5.5.0).
      Note that this constant is designed to change over time as new and stronger algorithms are added
      to PHP. For that reason, the length of the result from using this identifier can change over
      time. Therefore, it is recommended to store the result in a database column that can expand
      beyond 60 characters (255 characters would be a good choice).
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_BCRYPT</code></strong> - Use the <strong><code>CRYPT_BLOWFISH</code></strong> algorithm to
      create the hash. This will produce a standard <span class="function"><a href="function.crypt.php" class="function">crypt()</a></span> compatible hash using
      the &quot;$2y$&quot; identifier. The result will always be a 60 character string,  or <strong><code>false</code></strong> on failure.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_ARGON2I</code></strong> - Use the Argon2i hashing algorithm to create the hash.
      This algorithm is only available if PHP has been compiled with Argon2 support.
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <strong><code>PASSWORD_ARGON2ID</code></strong> - Use the Argon2id hashing algorithm to create the hash.
      This algorithm is only available if PHP has been compiled with Argon2 support.
     </span>
    </li>
   </ul>
  </p>
  <p class="simpara">
   Supported options for <strong><code>PASSWORD_BCRYPT</code></strong>:
  </p>
  <p class="para">
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <code class="literal">salt</code> (<span class="type">string</span>) - to manually provide a salt to use when hashing the password.
      Note that this will override and prevent a salt from being automatically generated.
     </p>
     <p class="para">
      If omitted, a random salt will be generated by <span class="function"><strong>password_hash()</strong></span> for
      each password hashed. This is the intended mode of operation.
     </p>
     <div class="warning"><strong class="warning">Warning</strong>
      <p class="para">
       The salt option is deprecated. It is now
       preferred to simply use the salt that is generated by default.
       As of PHP 8.0.0, an explicitly given salt is ignored.
      </p>
     </div>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">cost</code> (<span class="type">int</span>) - which denotes the algorithmic cost that should be used. 
      Examples of these values can be found on the <span class="function"><a href="function.crypt.php" class="function">crypt()</a></span> page.
     </p>
     <p class="para">
      If omitted, a default value of <code class="literal">10</code> will be used. This is a good
      baseline cost, but you may want to consider increasing it depending on your hardware.
     </p>
    </li>
   </ul>
  </p>
  <p class="simpara">
   Supported options for <strong><code>PASSWORD_ARGON2I</code></strong>
   and <strong><code>PASSWORD_ARGON2ID</code></strong>:
  </p>
  <p class="para">
   <ul class="itemizedlist">
    <li class="listitem">
     <p class="para">
      <code class="literal">memory_cost</code> (<span class="type">int</span>) - Maximum memory (in kibibytes) that may 
      be used to compute the Argon2 hash. Defaults to <strong><code>PASSWORD_ARGON2_DEFAULT_MEMORY_COST</code></strong>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">time_cost</code> (<span class="type">int</span>) - Maximum amount of time it may 
      take to compute the Argon2 hash. Defaults to <strong><code>PASSWORD_ARGON2_DEFAULT_TIME_COST</code></strong>.
     </p>
    </li>
    <li class="listitem">
     <p class="para">
      <code class="literal">threads</code> (<span class="type">int</span>) - Number of threads to use for computing 
      the Argon2 hash. Defaults to <strong><code>PASSWORD_ARGON2_DEFAULT_THREADS</code></strong>.
     </p>
     <div class="warning"><strong class="warning">Warning</strong>
      <p class="para">
        Only available when PHP uses libargon2, not with libsodium implementation.
      </p>
     </div>
    </li>
   </ul>
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.password-hash-parameters">
  <h3 class="title">Parameters</h3>
  <dl>
   
    <dt>
<code class="parameter">password</code></dt>

    <dd>

     <p class="para">
      The user&#039;s password.
     </p>
      <div class="caution"><strong class="caution">Caution</strong>
       <p class="para">
        Using the <strong><code>PASSWORD_BCRYPT</code></strong> as the
        algorithm, will result
        in the <code class="parameter">password</code> parameter being truncated to a
        maximum length of 72 bytes.
       </p>
      </div>
    </dd>

   
   
    <dt>
<code class="parameter">algo</code></dt>

    <dd>

     <p class="para">
      A <a href="password.constants.php" class="link">password algorithm constant</a> denoting the algorithm to use when hashing the password.
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">options</code></dt>

    <dd>

     <p class="para">
      An associative array containing options. See the <a href="password.constants.php" class="link">password algorithm constants</a> for documentation on the supported options for each algorithm.
     </p>
     <p class="para">
      If omitted, a random salt will be created and the default cost will be
      used.
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.password-hash-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the hashed password.
  </p>
  <p class="para">
   The used algorithm, cost and salt are returned as part of the hash. Therefore,
   all information that&#039;s needed to verify the hash is included in it. This allows
   the <span class="function"><a href="function.password-verify.php" class="function">password_verify()</a></span> function to verify the hash without
   needing separate storage for the salt or algorithm information.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.password-hash-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>8.0.0</td>
       <td>
        <span class="function"><strong>password_hash()</strong></span> no longer returns <strong><code>false</code></strong> on failure.
       </td>
      </tr>

      <tr>
       <td>8.0.0</td>
       <td>
        The <code class="parameter">algo</code> parameter is nullable now.
       </td>
      </tr>

      <tr>
       <td>7.4.0</td>
       <td>
        The <code class="parameter">algo</code> parameter expects a <span class="type">string</span> now, but still accepts
        <span class="type">int</span>s for backward compatibility.
       </td>
      </tr>

      <tr>
       <td>7.4.0</td>
       <td>
        The sodium extension provides an alternative implementation for Argon2 passwords.
       </td>
      </tr>

      <tr>
       <td>7.3.0</td>
       <td>
        Support for Argon2id passwords using <strong><code>PASSWORD_ARGON2ID</code></strong> was added.
       </td>
      </tr>

      <tr>
       <td>7.2.0</td>
       <td>
        Support for Argon2i passwords using <strong><code>PASSWORD_ARGON2I</code></strong> was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.password-hash-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   <div class="example" id="example-956">
    <p><strong>Example #1 <span class="function"><strong>password_hash()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br />&nbsp;*&nbsp;We&nbsp;just&nbsp;want&nbsp;to&nbsp;hash&nbsp;our&nbsp;password&nbsp;using&nbsp;the&nbsp;current&nbsp;DEFAULT&nbsp;algorithm.<br />&nbsp;*&nbsp;This&nbsp;is&nbsp;presently&nbsp;BCRYPT,&nbsp;and&nbsp;will&nbsp;produce&nbsp;a&nbsp;60&nbsp;character&nbsp;result.<br />&nbsp;*<br />&nbsp;*&nbsp;Beware&nbsp;that&nbsp;DEFAULT&nbsp;may&nbsp;change&nbsp;over&nbsp;time,&nbsp;so&nbsp;you&nbsp;would&nbsp;want&nbsp;to&nbsp;prepare<br />&nbsp;*&nbsp;By&nbsp;allowing&nbsp;your&nbsp;storage&nbsp;to&nbsp;expand&nbsp;past&nbsp;60&nbsp;characters&nbsp;(255&nbsp;would&nbsp;be&nbsp;good)<br />&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">"rasmuslerdorf"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PASSWORD_DEFAULT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
$2y$10$.vGA1O9wmRjrwAVXD98HNOgsNpDczlqm3Jq7KnEd1rVAGv3Fykk1a
</pre></div>
    </div>
   </div>
  </p> 
  <p class="para">
   <div class="example" id="example-957">
    <p><strong>Example #2 <span class="function"><strong>password_hash()</strong></span> example setting cost manually</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br />&nbsp;*&nbsp;In&nbsp;this&nbsp;case,&nbsp;we&nbsp;want&nbsp;to&nbsp;increase&nbsp;the&nbsp;default&nbsp;cost&nbsp;for&nbsp;BCRYPT&nbsp;to&nbsp;12.<br />&nbsp;*&nbsp;Note&nbsp;that&nbsp;we&nbsp;also&nbsp;switched&nbsp;to&nbsp;BCRYPT,&nbsp;which&nbsp;will&nbsp;always&nbsp;be&nbsp;60&nbsp;characters.<br />&nbsp;*/<br /></span><span style="color: #0000BB">$options&nbsp;</span><span style="color: #007700">=&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'cost'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">12</span><span style="color: #007700">,<br />];<br />echo&nbsp;</span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">"rasmuslerdorf"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PASSWORD_BCRYPT</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$options</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
$2y$12$QjSH496pcT5CEbzjD/vtVeH03tfHKFy36d4J0Ltp3lRtee9HDxY3K
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-958">
    <p><strong>Example #3 <span class="function"><strong>password_hash()</strong></span> example finding a good cost</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br />&nbsp;*&nbsp;This&nbsp;code&nbsp;will&nbsp;benchmark&nbsp;your&nbsp;server&nbsp;to&nbsp;determine&nbsp;how&nbsp;high&nbsp;of&nbsp;a&nbsp;cost&nbsp;you&nbsp;can<br />&nbsp;*&nbsp;afford.&nbsp;You&nbsp;want&nbsp;to&nbsp;set&nbsp;the&nbsp;highest&nbsp;cost&nbsp;that&nbsp;you&nbsp;can&nbsp;without&nbsp;slowing&nbsp;down<br />&nbsp;*&nbsp;you&nbsp;server&nbsp;too&nbsp;much.&nbsp;8-10&nbsp;is&nbsp;a&nbsp;good&nbsp;baseline,&nbsp;and&nbsp;more&nbsp;is&nbsp;good&nbsp;if&nbsp;your&nbsp;servers<br />&nbsp;*&nbsp;are&nbsp;fast&nbsp;enough.&nbsp;The&nbsp;code&nbsp;below&nbsp;aims&nbsp;for&nbsp;â‰¤&nbsp;50&nbsp;milliseconds&nbsp;stretching&nbsp;time,<br />&nbsp;*&nbsp;which&nbsp;is&nbsp;a&nbsp;good&nbsp;baseline&nbsp;for&nbsp;systems&nbsp;handling&nbsp;interactive&nbsp;logins.<br />&nbsp;*/<br /></span><span style="color: #0000BB">$timeTarget&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0.05</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;50&nbsp;milliseconds&nbsp;<br /><br /></span><span style="color: #0000BB">$cost&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">8</span><span style="color: #007700">;<br />do&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$cost</span><span style="color: #007700">++;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$start&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">"test"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PASSWORD_BCRYPT</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">"cost"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$cost</span><span style="color: #007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$end&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />}&nbsp;while&nbsp;((</span><span style="color: #0000BB">$end&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$start</span><span style="color: #007700">)&nbsp;&lt;&nbsp;</span><span style="color: #0000BB">$timeTarget</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #DD0000">"Appropriate&nbsp;Cost&nbsp;Found:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$cost</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Appropriate Cost Found: 10
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-959">
    <p><strong>Example #4 <span class="function"><strong>password_hash()</strong></span> example using Argon2i</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'Argon2i&nbsp;hash:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">password_hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PASSWORD_ARGON2I</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Argon2i hash: $argon2i$v=19$m=1024,t=2,p=2$YzJBSzV4TUhkMzc3d3laeg$zqU/1IN0/AogfP4cmSJI1vc8lpXRW9/S0sYY2i2jHT0
</pre></div>
    </div>
   </div>
  </p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.password-hash-notes">
  <h3 class="title">Notes</h3>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    It is strongly recommended that you do not generate your own salt for this
    function.  It will create a secure salt automatically for you if you do
    not specify one.
   </p>
   <p class="para">
    As noted above, providing the <code class="literal">salt</code> option in PHP 7.0
    will generate a deprecation warning. Support for providing a salt manually
    may be removed in a future PHP release.
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    It is recommended that you test this function on your servers, and adjust the cost parameter 
    so that execution of the function takes less than 100 milliseconds on interactive systems. 
    The script in the above example will help you choose a good cost value for your hardware.
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    Updates to supported algorithms by this function (or changes to the default one) must follow 
    the following rules:
   </span>
   <p class="para">
    <ul class="itemizedlist">
     <li class="listitem">
      <span class="simpara">
      Any new algorithm must be in core for at least 1 full release of PHP
      prior to becoming default. So if, for example, a new algorithm is added
      in 7.5.5, it would not be eligible for default until 7.7 (since 7.6
      would be the first full release). But if a different algorithm was added
      in 7.6.0, it would also be eligible for default at 7.7.0.
      </span>
     </li>
     <li class="listitem">
      <span class="simpara">
       The default should only change in a full release (7.3.0, 8.0.0, etc)
       and not in a revision release.  The only exception to this is in an
       emergency when a critical security flaw is found in the current
       default.
      </span>
     </li>
    </ul>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.password-hash-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.password-verify.php" class="function" rel="rdfs-seeAlso">password_verify()</a> - Verifies that a password matches a hash</span></li>
    <li class="member"><span class="function"><a href="function.crypt.php" class="function" rel="rdfs-seeAlso">crypt()</a> - One-way string hashing</span></li>
    <li class="member"><a href="https://github.com/ircmaxell/password_compat" class="link external">&raquo;&nbsp;userland implementation</a></li>
    <li class="member"><span class="function"><a href="function.sodium-crypto-pwhash-str.php" class="function" rel="rdfs-seeAlso">sodium_crypto_pwhash_str()</a> - Get an ASCII-encoded hash</span></li>
   </ul>
  </p>
 </div>


</div>
<section id="usernotes">
 <div class="head">
  <span class="action"><a href="/manual/add-note.php?sect=function.password-hash&amp;redirect=https://www.php.net/manual/en/function.password-hash.php"><img src='/images/notes-add@2x.png' alt='add a note' width='12' height='12'> <small>add a note</small></a></span>
  <h3 class="title">User Contributed Notes <span class="count">12 notes</span></h3>
 </div><div id="allnotes">
  <div class="note" id="110872">  <div class="votes">
    <div id="Vu110872">
    <a href="/manual/vote-note.php?id=110872&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd110872">
    <a href="/manual/vote-note.php?id=110872&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V110872" title="76% like this...">
    167
    </div>
  </div>
  <a href="#110872" class="name">
  <strong class="user"><em>martinstoeckli</em></strong></a><a class="genanchor" href="#110872"> &para;</a><div class="date" title="2012-12-17 08:56"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom110872">
<div class="phpcode"><code><span class="html">
There is a compatibility pack available for PHP versions 5.3.7 and later, so you don't have to wait on version 5.5 for using this function. It comes in form of a single php file:<br /><a href="https://github.com/ircmaxell/password_compat" rel="nofollow" target="_blank">https://github.com/ircmaxell/password_compat</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="124138">  <div class="votes">
    <div id="Vu124138">
    <a href="/manual/vote-note.php?id=124138&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124138">
    <a href="/manual/vote-note.php?id=124138&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124138" title="79% like this...">
    88
    </div>
  </div>
  <a href="#124138" class="name">
  <strong class="user"><em>phpnetcomment201908 at lucb1e dot com</em></strong></a><a class="genanchor" href="#124138"> &para;</a><div class="date" title="2019-08-25 02:17"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom124138">
<div class="phpcode"><code><span class="html">
Since 2017, NIST recommends using a secret input when hashing memorized secrets such as passwords. By mixing in a secret input (commonly called a "pepper"), one prevents an attacker from brute-forcing the password hashes altogether, even if they have the hash and salt. For example, an SQL injection typically affects only the database, not files on disk, so a pepper stored in a config file would still be out of reach for the attacker. A pepper must be randomly generated once and can be the same for all users. Many password leaks could have been made completely useless if site owners had done this.<br /><br />Since there is no pepper parameter for password_hash (even though Argon2 has a "secret" parameter, PHP does not allow to set it), the correct way to mix in a pepper is to use hash_hmac(). The "add note" rules of php.net say I can't link external sites, so I can't back any of this up with a link to NIST, Wikipedia, posts from the security stackexchange site that explain the reasoning, or anything... You'll have to verify this manually. The code:<br /><br />// config.conf<br />pepper=c1isvFdxMDdmjOlvxpecFw<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">// register.php<br /></span><span class="default">$pepper </span><span class="keyword">= </span><span class="default">getConfigVariable</span><span class="keyword">(</span><span class="string">"pepper"</span><span class="keyword">);<br /></span><span class="default">$pwd </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">];<br /></span><span class="default">$pwd_peppered </span><span class="keyword">= </span><span class="default">hash_hmac</span><span class="keyword">(</span><span class="string">"sha256"</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">, </span><span class="default">$pepper</span><span class="keyword">);<br /></span><span class="default">$pwd_hashed </span><span class="keyword">= </span><span class="default">password_hash</span><span class="keyword">(</span><span class="default">$pwd_peppered</span><span class="keyword">, </span><span class="default">PASSWORD_ARGON2ID</span><span class="keyword">);<br /></span><span class="default">add_user_to_database</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">, </span><span class="default">$pwd_hashed</span><span class="keyword">);<br /></span><span class="default">?&gt;<br /></span><br /><span class="default">&lt;?php<br /></span><span class="comment">// login.php<br /></span><span class="default">$pepper </span><span class="keyword">= </span><span class="default">getConfigVariable</span><span class="keyword">(</span><span class="string">"pepper"</span><span class="keyword">);<br /></span><span class="default">$pwd </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">];<br /></span><span class="default">$pwd_peppered </span><span class="keyword">= </span><span class="default">hash_hmac</span><span class="keyword">(</span><span class="string">"sha256"</span><span class="keyword">, </span><span class="default">$pwd</span><span class="keyword">, </span><span class="default">$pepper</span><span class="keyword">);<br /></span><span class="default">$pwd_hashed </span><span class="keyword">= </span><span class="default">get_pwd_from_db</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">);<br />if (</span><span class="default">password_verify</span><span class="keyword">(</span><span class="default">$pwd_peppered</span><span class="keyword">, </span><span class="default">$pwd_hashed</span><span class="keyword">)) {<br />&nbsp; &nbsp; echo </span><span class="string">"Password matches."</span><span class="keyword">;<br />}<br />else {<br />&nbsp; &nbsp; echo </span><span class="string">"Password incorrect."</span><span class="keyword">;<br />}<br /></span><span class="default">?&gt;<br /></span><br />Note that this code contains a timing attack that leaks whether the username exists. But my note was over the length limit so I had to cut this paragraph out.<br /><br />Also note that the pepper is useless if leaked or if it can be cracked. Consider how it might be exposed, for example different methods of passing it to a docker container. Against cracking, use a long randomly generated value (like in the example above), and change the pepper when you do a new install with a clean user database. Changing the pepper for an existing database is the same as changing other hashing parameters: you can either wrap the old value in a new one and layer the hashing (more complex), you compute the new password hash whenever someone logs in (leaving old users at risk, so this might be okay depending on what the reason is that you're upgrading).<br /><br />Why does this work? Because an attacker does the following after stealing the database:<br /><br />password_verify("a", $stolen_hash)<br />password_verify("b", $stolen_hash)<br />...<br />password_verify("z", $stolen_hash)<br />password_verify("aa", $stolen_hash)<br />etc.<br /><br />(More realistically, they use a cracking dictionary, but in principle, the way to crack a password hash is by guessing. That's why we use special algorithms: they are slower, so each verify() operation will be slower, so they can try much fewer passwords per hour of cracking.)<br /><br />Now what if you used that pepper? Now they need to do this:<br /><br />password_verify(hmac_sha256("a", $secret), $stolen_hash)<br /><br />Without that $secret (the pepper), they can't do this computation. They would have to do:<br /><br />password_verify(hmac_sha256("a", "a"), $stolen_hash)<br />password_verify(hmac_sha256("a", "b"), $stolen_hash)<br />...<br />etc., until they found the correct pepper.<br /><br />If your pepper contains 128 bits of entropy, and so long as hmac-sha256 remains secure (even MD5 is technically secure for use in hmac: only its collision resistance is broken, but of course nobody would use MD5 because more and more flaws are found), this would take more energy than the sun outputs. In other words, it's currently impossible to crack a pepper that strong, even given a known password and salt.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113397">  <div class="votes">
    <div id="Vu113397">
    <a href="/manual/vote-note.php?id=113397&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113397">
    <a href="/manual/vote-note.php?id=113397&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113397" title="70% like this...">
    44
    </div>
  </div>
  <a href="#113397" class="name">
  <strong class="user"><em>nicoSWD</em></strong></a><a class="genanchor" href="#113397"> &para;</a><div class="date" title="2013-10-06 03:29"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom113397">
<div class="phpcode"><code><span class="html">
I agree with martinstoeckli,<br /><br />don't create your own salts unless you really know what you're doing.<br /><br />By default, it'll use /dev/urandom to create the salt, which is based on noise from device drivers.<br /><br />And on Windows, it uses CryptGenRandom().<br /><br />Both have been around for many years, and are considered secure for cryptography (the former probably more than the latter, though).<br /><br />Don't try to outsmart these defaults by creating something less secure. Anything that is based on rand(), mt_rand(), uniqid(), or variations of these is *not* good.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113490">  <div class="votes">
    <div id="Vu113490">
    <a href="/manual/vote-note.php?id=113490&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd113490">
    <a href="/manual/vote-note.php?id=113490&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V113490" title="58% like this...">
    33
    </div>
  </div>
  <a href="#113490" class="name">
  <strong class="user"><em>Cloxy</em></strong></a><a class="genanchor" href="#113490"> &para;</a><div class="date" title="2013-10-18 09:45"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom113490">
<div class="phpcode"><code><span class="html">
You can produce the same hash in php 5.3.7+ with crypt() function:<br /><br /><span class="default">&lt;?php<br /><br />$salt </span><span class="keyword">= </span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">22</span><span class="keyword">, </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">);<br /></span><span class="default">$salt </span><span class="keyword">= </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$salt</span><span class="keyword">);<br /></span><span class="default">$salt </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'+'</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$salt</span><span class="keyword">);<br /></span><span class="default">$hash </span><span class="keyword">= </span><span class="default">crypt</span><span class="keyword">(</span><span class="string">'rasmuslerdorf'</span><span class="keyword">, </span><span class="string">'$2y$10$'</span><span class="keyword">.</span><span class="default">$salt</span><span class="keyword">.</span><span class="string">'$'</span><span class="keyword">);<br /><br />echo </span><span class="default">$hash</span><span class="keyword">;<br /><br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118603">  <div class="votes">
    <div id="Vu118603">
    <a href="/manual/vote-note.php?id=118603&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd118603">
    <a href="/manual/vote-note.php?id=118603&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V118603" title="59% like this...">
    17
    </div>
  </div>
  <a href="#118603" class="name">
  <strong class="user"><em>Lyo Mi</em></strong></a><a class="genanchor" href="#118603"> &para;</a><div class="date" title="2016-01-06 06:11"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom118603">
<div class="phpcode"><code><span class="html">
Please note that password_hash will ***truncate*** the password at the first NULL-byte.<br /><br /><a href="http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html" rel="nofollow" target="_blank">http://blog.ircmaxell.com/2015/03/security-issue-combining-bcrypt-with.html</a><br /><br />If you use anything as an input that can generate NULL bytes (sha1 with raw as true, or if NULL bytes can naturally end up in people's passwords), you may make your application much less secure than what you might be expecting.<br /><br />The password <br />$a = "\01234567"; <br />is zero bytes long (an empty password) for bcrypt.<br /><br />The workaround, of course, is to make sure you don't ever pass NULL-bytes to password_hash.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111620">  <div class="votes">
    <div id="Vu111620">
    <a href="/manual/vote-note.php?id=111620&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd111620">
    <a href="/manual/vote-note.php?id=111620&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V111620" title="57% like this...">
    15
    </div>
  </div>
  <a href="#111620" class="name">
  <strong class="user"><em>martinstoeckli</em></strong></a><a class="genanchor" href="#111620"> &para;</a><div class="date" title="2013-03-08 10:36"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom111620">
<div class="phpcode"><code><span class="html">
In most cases it is best to omit the salt parameter. Without this parameter, the function will generate a cryptographically safe salt, from the random source of the operating system.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115629">  <div class="votes">
    <div id="Vu115629">
    <a href="/manual/vote-note.php?id=115629&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd115629">
    <a href="/manual/vote-note.php?id=115629&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V115629" title="57% like this...">
    11
    </div>
  </div>
  <a href="#115629" class="name">
  <strong class="user"><em>Mike Robinson</em></strong></a><a class="genanchor" href="#115629"> &para;</a><div class="date" title="2014-08-28 02:52"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom115629">
<div class="phpcode"><code><span class="html">
For passwords, you generally want the hash calculation time to be between 250 and 500 ms (maybe more for administrator accounts). Since calculation time is dependent on the capabilities of the server, using the same cost parameter on two different servers may result in vastly different execution times. Here's a quick little function that will help you determine what cost parameter you should be using for your server to make sure you are within this range (note, I am providing a salt to eliminate any latency caused by creating a pseudorandom salt, but this should not be done when hashing passwords):<br /><br /><span class="default">&lt;?php<br /></span><span class="comment">/**<br /> * @Param int $min_ms Minimum amount of time in milliseconds that it should take<br /> * to calculate the hashes<br /> */<br /></span><span class="keyword">function </span><span class="default">getOptimalBcryptCostParameter</span><span class="keyword">(</span><span class="default">$min_ms </span><span class="keyword">= </span><span class="default">250</span><span class="keyword">) {<br />&nbsp; &nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">31</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$options </span><span class="keyword">= [ </span><span class="string">'cost' </span><span class="keyword">=&gt; </span><span class="default">$i</span><span class="keyword">, </span><span class="string">'salt' </span><span class="keyword">=&gt; </span><span class="string">'usesomesillystringforsalt' </span><span class="keyword">];<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$time_start </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">password_hash</span><span class="keyword">(</span><span class="string">"rasmuslerdorf"</span><span class="keyword">, </span><span class="default">PASSWORD_BCRYPT</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$time_end </span><span class="keyword">= </span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />&nbsp; &nbsp; &nbsp; &nbsp; if ((</span><span class="default">$time_end </span><span class="keyword">- </span><span class="default">$time_start</span><span class="keyword">) * </span><span class="default">1000 </span><span class="keyword">&gt; </span><span class="default">$min_ms</span><span class="keyword">) {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$i</span><span class="keyword">;<br />&nbsp; &nbsp; &nbsp; &nbsp; }<br />&nbsp; &nbsp; }<br />}<br />echo </span><span class="default">getOptimalBcryptCostParameter</span><span class="keyword">(); </span><span class="comment">// prints 12 in my case<br /></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124294">  <div class="votes">
    <div id="Vu124294">
    <a href="/manual/vote-note.php?id=124294&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124294">
    <a href="/manual/vote-note.php?id=124294&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124294" title="53% like this...">
    1
    </div>
  </div>
  <a href="#124294" class="name">
  <strong class="user"><em>ms1 at rdrecs dot com</em></strong></a><a class="genanchor" href="#124294"> &para;</a><div class="date" title="2019-10-14 05:07"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom124294">
<div class="phpcode"><code><span class="html">
Timing attacks simply put, are attacks that can calculate what characters of the password are due to speed of the execution.<br /><br />More at...<br /><a href="https://paragonie.com/blog/2015/11/preventing-timing-attacks-on-string-comparison-with-double-hmac-strategy" rel="nofollow" target="_blank">https://paragonie.com/blog/2015/11/preventing-timing-attacks-on-string-comparison-with-double-hmac-strategy</a><br /><br />I have added code to phpnetcomment201908 at lucb1e dot com's suggestion to make this possible "timing attack" more difficult using the code phpnetcomment201908 at lucb1e dot com posted.<br /><br />$pph_strt = microtime(true);<br /><br />//...<br />/*The code he posted for login.php*/<br />//...<br /><br />$end = (microtime(true) - $pph_strt);<br /><br />$wait = bcmul((1 - $end), 1000000);&nbsp; // usleep(250000) 1/4 of a second<br /><br />usleep ( $wait );<br /><br />echo "&lt;br&gt;Execution time:".(microtime(true) - $pph_strt)."; ";<br /><br />Note I suggest changing the wait time to suit your needs but make sure that it is more than than the highest execution time the script takes on your server.<br /><br />Also, this is my workaround to obfuscate the execution time to nullify timing attacks. You can find an in-depth discussion and more from people far more equipped than I for cryptography at the link I posted. I do not believe this was there but there are others. It is where I found out what timing attacks were as I am new to this but would like solid security.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125019">  <div class="votes">
    <div id="Vu125019">
    <a href="/manual/vote-note.php?id=125019&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125019">
    <a href="/manual/vote-note.php?id=125019&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125019" title="46% like this...">
    -1
    </div>
  </div>
  <a href="#125019" class="name">
  <strong class="user"><em>php dot net at marksim dot org</em></strong></a><a class="genanchor" href="#125019"> &para;</a><div class="date" title="2020-05-17 07:56"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125019">
<div class="phpcode"><code><span class="html">
regarding the sentence "...database column that can expand beyond 60 characters (255 characters would be a good choice). "<br /><br />Considering future hash length increase by factor *2 and considering databases to start counting with 1, a password length of 256 characters (not 255) would probably be the better choice :)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123949">  <div class="votes">
    <div id="Vu123949">
    <a href="/manual/vote-note.php?id=123949&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd123949">
    <a href="/manual/vote-note.php?id=123949&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V123949" title="38% like this...">
    -7
    </div>
  </div>
  <a href="#123949" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="#123949"> &para;</a><div class="date" title="2019-06-18 01:09"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123949">
<div class="phpcode"><code><span class="html">
According to the draft specification, Argon2di is the recommended mode of operation:<br /><br />&gt; 9.4.&nbsp; Recommendations<br />&gt;<br />&gt;&nbsp;&nbsp; The Argon2id variant with t=1 and maximum available memory is<br />&gt;&nbsp;&nbsp; recommended as a default setting for all environments.&nbsp; This setting<br />&gt;&nbsp;&nbsp; is secure against side-channel attacks and maximizes adversarial<br />&gt;&nbsp;&nbsp; costs on dedicated bruteforce hardware.<br /><br />source: <a href="https://tools.ietf.org/html/draft-irtf-cfrg-argon2-06#section-9.4" rel="nofollow" target="_blank">https://tools.ietf.org/html/draft-irtf-cfrg-argon2-06#section-9.4</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="125094">  <div class="votes">
    <div id="Vu125094">
    <a href="/manual/vote-note.php?id=125094&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd125094">
    <a href="/manual/vote-note.php?id=125094&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V125094" title="28% like this...">
    -6
    </div>
  </div>
  <a href="#125094" class="name">
  <strong class="user"><em>Anonymous</em></strong></a><a class="genanchor" href="#125094"> &para;</a><div class="date" title="2020-06-07 02:11"><strong>1 year ago</strong></div>
  <div class="text" id="Hcom125094">
<div class="phpcode"><code><span class="html">
To use argon, follow these steps:<br /><br />```<br />git clone <a href="https://github.com/p-h-c/phc-winner-argon2" rel="nofollow" target="_blank">https://github.com/p-h-c/phc-winner-argon2</a><br />cd phc-winner-argon2 &amp;&amp; make &amp;&amp; make install<br />apt install libsodium-dev<br />cd ~/php-7.4.5 // Your php installation source code<br />./configure [YOUR_EXISTING_CONFIGURE_COMMANDS] --with-password-argon2 --with-sodium<br />```</span>
</code></div>
  </div>
 </div>
  <div class="note" id="124189">  <div class="votes">
    <div id="Vu124189">
    <a href="/manual/vote-note.php?id=124189&amp;page=function.password-hash&amp;vote=up" title="Vote up!" class="usernotes-voteu">up</a>
    </div>
    <div id="Vd124189">
    <a href="/manual/vote-note.php?id=124189&amp;page=function.password-hash&amp;vote=down" title="Vote down!" class="usernotes-voted">down</a>
    </div>
    <div class="tally" id="V124189" title="23% like this...">
    -14
    </div>
  </div>
  <a href="#124189" class="name">
  <strong class="user"><em>hman</em></strong></a><a class="genanchor" href="#124189"> &para;</a><div class="date" title="2019-09-11 10:27"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom124189">
<div class="phpcode"><code><span class="html">
I believe a note should be added about the compatibility of crypt() and password_hash().<br /><br />My tests showed that yes, password_verify can also take hashes generated by crypt - as well as those from password_hash. But vice versa this is not true...<br /><br />You cannot put hashes generated by password_hash into crypt for comparing them themselves, when used as the salt for crypt, as was recommended years ago (compare user entry with user crypt(userentry,userentry). No big deal, but it means that password checking routines MUST immediately be rewritten to use password_hash...<br /><br />You cannot start using password_hash for hash generation without also altering the password check routine!<br /><br />So the word "compatible" should be, IMHO, ammended with a word of caution, hinting the reader, that compatibility here is a one-way street.</span>
</code></div>
  </div>
 </div></div>

 <div class="foot"><a href="/manual/add-note.php?sect=function.password-hash&amp;redirect=https://www.php.net/manual/en/function.password-hash.php"><img src='/images/notes-add@2x.png' alt='add a note' width='12' height='12'> <small>add a note</small></a></div>
</section>    </section><!-- layout-content -->
        <aside class='layout-menu'>

        <ul class='parent-menu-list'>
                                    <li>
                <a href="ref.password.php">Password Hashing Functions</a>

                                    <ul class='child-menu-list'>

                                                <li class="">
                            <a href="function.password-algos.php" title="password_&#8203;algos">password_&#8203;algos</a>
                        </li>
                                                <li class="">
                            <a href="function.password-get-info.php" title="password_&#8203;get_&#8203;info">password_&#8203;get_&#8203;info</a>
                        </li>
                                                <li class="current">
                            <a href="function.password-hash.php" title="password_&#8203;hash">password_&#8203;hash</a>
                        </li>
                                                <li class="">
                            <a href="function.password-needs-rehash.php" title="password_&#8203;needs_&#8203;rehash">password_&#8203;needs_&#8203;rehash</a>
                        </li>
                                                <li class="">
                            <a href="function.password-verify.php" title="password_&#8203;verify">password_&#8203;verify</a>
                        </li>
                        
                    </ul>
                
            </li>
                        
                    </ul>
    </aside>


  </div><!-- layout -->

  <footer>
    <div class="container footer-content">
      <div class="row-fluid">
      <ul class="footmenu">
        <li><a href="/copyright.php">Copyright &copy; 2001-2022 The PHP Group</a></li>
        <li><a href="/my.php">My PHP.net</a></li>
        <li><a href="/contact.php">Contact</a></li>
        <li><a href="/sites.php">Other PHP.net sites</a></li>
        <li><a href="/privacy.php">Privacy policy</a></li>
        <li><a href="https://github.com/php/web-php/blob/master/manual%2Fen%2Ffunction.password-hash.php">View Source</a></li>
      </ul>
      </div>
    </div>
  </footer>

    
 <!-- External and third party libraries. -->
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" integrity="sha384-aBL3Lzi6c9LNDGvpHkZrrm3ZVsIwohDD7CDozL0pk8FwCrfmV7H9w8j3L7ikEv6h" crossorigin="anonymous"></script>
<script src="/cached.php?t=1421837618&amp;f=/js/ext/modernizr.js"></script>
<script src="/cached.php?t=1421837618&amp;f=/js/ext/hogan-2.0.0.min.js"></script>
<script src="/cached.php?t=1421837618&amp;f=/js/ext/typeahead.min.js"></script>
<script src="/cached.php?t=1421837618&amp;f=/js/ext/mousetrap.min.js"></script>
<script src="/cached.php?t=1421837618&amp;f=/js/search.js"></script>
<script src="/cached.php?t=1637324403&amp;f=/js/common.js"></script>

<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="/images/to-top@2x.png"></a>

</body>
</html>
